# QDMZ Excel查询系统 - Excel文件格式规范

## 概述
本文档详细说明QDMZ Excel查询系统支持的Excel文件格式要求，包括XLS和XLSX格式。

## 支持的Excel格式

### 文件类型
- **XLS** - Microsoft Excel 97-2003 工作簿格式
- **XLSX** - Microsoft Excel Open XML 工作簿格式

### 文件大小限制
- 最大文件大小：100MB
- 建议文件大小：小于50MB以获得最佳性能

## 工作表要求

### 工作表数量
- **单工作表**：系统优先处理第一个工作表
- **多工作表**：系统仅处理第一个工作表，其余工作表将被忽略。

### 工作表命名
- 工作表名称无特殊要求
- 支持中文、英文及特殊字符
- 建议使用有意义的名称便于识别

## 数据结构要求

### 表头行
- **第一行为列名**：必须将第一行设置为列名
- **列名格式**：支持中文、英文、数字及特殊字符
- **列名唯一性**：建议各列名不重复，如重复系统将自动处理

### 数据行
- **从第二行开始**：第二行及以后为实际数据
- **数据类型**：支持文本、数字、日期等所有Excel数据类型
- **空行处理**：系统会跳过完全空白的行

## 列限制

### 最大列数
- **最大列数**：16,384列（Excel标准限制）
- **建议列数**：少于100列以获得最佳性能

### 列名要求
- **长度限制**：单个列名最多255个字符
- **字符支持**：支持中文、英文、数字、空格、下划线、连字符等
- **特殊字符**：支持大多数特殊字符，但避免使用系统保留字符

## 行限制

### 最大行数
- **最大行数**：1,048,576行（Excel标准限制）
- **建议行数**：少于100,000行以获得最佳性能
- **查询性能**：超过50,000行时查询时间可能显著增加

## 数据格式支持

### 文本数据
- 支持中文、英文、数字混合
- 支持特殊字符和符号
- 支持换行符（在单元格内）

### 数值数据
- 整数、小数
- 负数
- 科学计数法
- 百分比

### 日期时间
- 支持多种日期格式
- 支持时间格式
- 自动识别日期时间格式

### 其他数据类型
- 布尔值（TRUE/FALSE）
- 货币格式
- 自定义格式

## 格式和样式

### 单元格格式
- 系统仅读取单元格值，忽略格式设置
- 字体、颜色、边框等格式信息不会影响查询功能
- 合并单元格：建议避免使用合并单元格，可能导致数据读取异常

### 公式
- 系统读取公式计算后的值，而非公式本身
- 公式结果将作为查询数据使用

## 文件命名规范

### 文件名要求
- 支持中文文件名
- 支持英文文件名
- 支持数字、下划线、连字符
- 避免使用特殊字符：`<>:"/\|?*`等

### 文件名长度
- 建议文件名长度不超过255个字符
- 包含路径的完整文件名不超过4096个字符

## 性能优化建议

### 大文件处理
- 对于大型Excel文件，建议分批处理
- 移除不必要的空行和空列
- 避免在数据中使用复杂的格式设置

### 查询优化
- 将经常查询的列放在前面
- 保持数据类型一致性
- 避免在查询列中使用混合数据类型

## 常见问题

### 文件上传失败
- 检查文件大小是否超过限制
- 确认文件格式是否正确
- 检查文件是否被其他程序占用

### 数据读取异常
- 确认第一行为列名
- 检查是否有损坏的单元格格式
- 验证文件是否可以正常在Excel中打开

### 查询性能问题
- 检查数据行数是否过多
- 优化查询列的数据类型
- 考虑对大文件进行分割

## 示例文件结构

```
工作表1（系统处理的工作表）:
| 姓名   | 年龄 | 部门     | 入职日期   | 工资    |
|--------|------|----------|------------|---------|
| 张三   | 28   | 技术部   | 2023-01-15 | 8000.00 |
| 李四   | 32   | 销售部   | 2022-05-20 | 7500.50 |
| 王五   | 25   | 人事部   | 2024-03-10 | 6500.00 |
```

## 上传和管理

### 上传前检查清单
- [ ] 文件格式为XLS或XLSX
- [ ] 文件大小小于100MB
- [ ] 第一行为列名
- [ ] 数据从第二行开始
- [ ] 没有合并单元格
- [ ] 文件名不含特殊字符

### 最佳实践
- 定期备份重要Excel文件
- 为文件设置有意义的别名以便识别
- 定期清理不需要的文件以节省空间
- 对敏感数据进行适当的保护

---

**注意**：遵循以上格式规范可以确保Excel文件在QDMZ系统中正常工作，获得最佳的查询性能和用户体验。